<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title> • pophelperShiny</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="">
<meta property="og:description" content="">
<meta property="og:image" content="https://github.com/royfrancis/pophelperShiny/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">pophelperShiny</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.0.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-tools"></span>
     
    Guide
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/guide.html">UNKNOWN TITLE</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">
    <span class="fa fa-book"></span>
     
    Reference
  </a>
</li>
<li>
  <a href="../news/index.html">
    <span class="fa fa-history"></span>
     
    Versions
  </a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/royfrancis/pophelperShiny">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1></h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/royfrancis/pophelperShiny/blob/master/vignettes/guide.Rmd"><code>vignettes/guide.Rmd</code></a></small>
      <div class="hidden name"><code>guide.Rmd</code></div>

    </div>

    
    
<p></p>
<div id="general" class="section level2">
<h2 class="hasAnchor">
<a href="#general" class="anchor"></a>1. General</h2>
<ul>
<li>Once the app is loaded in the browser, the session is ready for use.<br>
</li>
<li>As long as the user interacts with the app, the session remains active. If the session is inactive for 10 mins, the session is automatically closed down. Data is erased after the session is closed and cannot be retrieved. Please download tables and plots that you wish to keep. This is applicable only to the online version of the app.</li>
<li>It is best to adjust widgets in the order from top left to bottom right. This is because once changes have been made to widgets further down, changes to top widgets may reset the settings of those below.</li>
<li>See section <strong>Troubleshooting</strong>.</li>
</ul>
</div>
<div id="features" class="section level2">
<h2 class="hasAnchor">
<a href="#features" class="anchor"></a>2. Features</h2>
<ul>
<li>Upload STRUCTURE, BAPS, fastSTRUCTURE, STRUCTURE, TESS or any tabular run files.<br>
</li>
<li>Tabulate and summarise runs by <em>K</em>.<br>
</li>
<li>Evanno method for estimation of optimal <em>K</em> for STRUCTURE files.</li>
<li>Single or joined barplots from any run file.<br>
</li>
<li>Adjust cluster colours</li>
<li>Align and/or merge clusters.<br>
</li>
<li>Label barplots with group labels.</li>
<li>Reorder groups.<br>
</li>
<li>Sort individuals by label, any cluster or all clusters.<br>
</li>
<li>Interactive barplot to zoom/pan and identify individuals.<br>
</li>
<li>Export all data tables and images in various formats.</li>
</ul>
</div>
<div id="file-upload" class="section level2">
<h2 class="hasAnchor">
<a href="#file-upload" class="anchor"></a>3. File upload</h2>
<p>Files are uploaded interactively in the <em>Upload</em> tab. <strong>Input format</strong> option <strong>Auto</strong> should generally work. The following file types are expected: STRUCTURE, BAPS, TESS, ADMIXTURE output files or fastSTRUCTURE meanQ files. If using files as inputs from other software or modified files, from spreadsheets etc, they must be all numeric tabular data without headers in tab-delimited, space-delimited or comma-separated format. Decimal must be defined by dot. Combined, aligned and merged CLUMPP file from R package <code>pophelper</code> is also supported. If you think, a file format is incorrectly identified, you can manually set <strong>Input format</strong>. <strong>Mixed file formats are not supported</strong>.</p>
<p>On successful completion of upload, a summary table of uploaded files is shown. Fields shown are filename, file format and size of the file. File formats identified are STRUCTURE, BAPS, TESS, CLUMPP or BASIC files. Other text files or files of incorrect format are displayed as UNIDENTIFIED. ADMIXTURE and fastSTRUCTURE files are simple tables without headers differing in delimiter spaces. Any text file that is all numeric in a tabular format with space/tab/comma delimiter will be identified as BASIC format.</p>
<div class="figure">
<img src="www/inputpreview.jpg" alt="Input preview"><p class="caption">Input preview</p>
</div>
<p><b>Fig. </b> 1: <em>A preview of the input files. STRUCTURE file (Left), TESS file (centre) and BASIC (ADMIXTURE) file (right). To download sample files, see downloads section.</em></p>
</div>
<div id="data" class="section level2">
<h2 class="hasAnchor">
<a href="#data" class="anchor"></a>4. Data</h2>
<p>The <em>Data</em> tab shows tabulated and summarised tables.</p>
<div id="tabulated-data" class="section level3">
<h3 class="hasAnchor">
<a href="#tabulated-data" class="anchor"></a>4.1 Tabulated data</h3>
<p>A tabulated table is displayed for a set of one or more identified run files. Tabulated data lists all runs sorted by loci, individuals and <em>K</em> for STRUCTURE runs. The table is sorted by individuals and <em>K</em> for other run formats. Tabulated data is not displayed if uploaded files consist of mixed formats. The tabulated data can be download using the download button the left side.</p>
</div>
<div id="summarised-data" class="section level3">
<h3 class="hasAnchor">
<a href="#summarised-data" class="anchor"></a>4.2 Summarised data</h3>
<p>The summarised table is created from the tabulated table. For STRUCTURE runs, the summarised data table is sorted by <strong>loci</strong>, <strong>ind</strong>, <em>K</em> and runs followed by <strong>elpdmean</strong>, <strong>elpdsd</strong>, <strong>elpdmin</strong> and <strong>elpdmax</strong>. For other run formats, the table is sorted by <strong>ind</strong>, <em>K</em> and <strong>runs</strong>. Summarised data is not displayed if uploaded files consist of mixed formats. The summarised data can be download using the download button the left side.</p>
</div>
</div>
<div id="evanno-method" class="section level2">
<h2 class="hasAnchor">
<a href="#evanno-method" class="anchor"></a>5. Evanno method</h2>
<p>The Evanno method is used to estimate the number of <em>K</em>. The method is based on Evanno et al., (2005) and only applicable to STRUCTURE runs. The Evanno method can be performed in the <em>Evanno</em> tab.</p>
<p>The <em>Input</em> tab shows a tabulated list of STRUCTURE files on the left side. By default, all runs are selected. A subset of runs can be used for the Evanno analysis by selecting (by clicking) the rows/runs in the input table. A K-Plot (Mean of Estimated Log-likelihood over <em>K</em>) for the selected run is shown on the right side.</p>
<p>The <em>Output</em> tab shows a table of the Evanno results showing various derivatives as well as a scatterplots based on the same table. The data is available to download as a text file.</p>
<p>The Evanno method is computed only if the selected runs fulfill the following criteria:</p>
<ul>
<li>At least 3 different values of <em>K</em><br>
</li>
<li>At least 2 repeats for each value of <em>K</em>
</li>
<li>Number of loci must be same across all <em>K</em><br>
</li>
<li>Number of individuals must be same across all <em>K</em><br>
</li>
<li>Sequentially increasing values of <em>K</em>. For example, <em>K</em> values cannot be 2,3 and then 5.</li>
</ul>
<p>This is the minimum requirement. Evanno method benefits from having several repeats for each <em>K</em> across a wide range of <em>K</em>. The Evanno results table and plot can be downloaded using the download options on the left of the page.</p>
<div class="figure">
<img src="www/evanno-plot.png" alt="evanno-plot"><p class="caption">evanno-plot</p>
</div>
<p><b>Fig. </b> 2: <em>An Evanno method output plot.</em></p>
</div>
<div id="plotting" class="section level2">
<h2 class="hasAnchor">
<a href="#plotting" class="anchor"></a>6. Plotting</h2>
<p>Two types of plots are available: <strong>Standard Plot</strong> and <strong>Interactive Plot</strong>. For finer control and print, the <strong>Standard Plot</strong> may be better. For quick assessment of results using mouse hover tool tips and zoom control, use <strong>Interactive Plot</strong>.</p>
<div id="plot-options" class="section level3">
<h3 class="hasAnchor">
<a href="#plot-options" class="anchor"></a>6.1 Plot options</h3>
<p>The <strong>Plot options</strong> are common for Standard and Interactive plots.</p>
<p>A list of uploaded files are displayed. The default selection type is <strong>Datatable</strong>. With this, the selection order is maintained. In case the <strong>Datatable</strong> option does not work, the <strong>Picker</strong> option is available. In this case, the selection order is not maintained.</p>
<p>Runs to be plotted needs to be selected. The run is plotted as a barplot on the right side. If more than one run is selected, then runs are plotted one below the other as joined plots. Multiple plots are plotted as joined plots for standard plot and plotted separately for interactive plots.</p>
<div id="colour-palette" class="section level4">
<h4 class="hasAnchor">
<a href="#colour-palette" class="anchor"></a>6.1.1 Colour palette</h4>
<p>A selection of colour palettes are available to colour the clusters on barplots. The default is the <strong>Rich</strong> colour palette. Selecting any colour palette generates input widgets with colours equal to the max number of clusters in the selected runs. The colours are selected based on the palette, but can be changed if required. Manually input colours must be in hexadecimal format or picked using the colour picker. Input must look like this: <code>#2121D9</code>. Transparency is not supported. The number of colours available in each palette is shown in parenthesis <code>()</code>. If a number is not displayed, then there are no limits to the number of colours. Colour palettes are grouped into Function-based colours (FB) and Pre-defined colours (PD). PD and FB have slightly different properties.</p>
<div id="function-based-colours" class="section level5">
<h5 class="hasAnchor">
<a href="#function-based-colours" class="anchor"></a>6.1.1.1 Function-based colours</h5>
<p>FB colours are generated from a function. FB colours are not limited in numbers and can take any <em>K</em> value. New colours are added to the middle of the sequence as <em>K</em> increases. For example, <strong>Rich</strong> palette produces Blue and Red for <em>K</em>=2 and Blue, LightBlue and Red when <em>K</em>=3 and Blue, LightBlue, Yellow and Red when <em>K</em>=4 etc. Function-based colour schemes are shown below.</p>
<p><img src="guide_files/figure-html/unnamed-chunk-3-1.png" width="576" style="display: block; margin: auto auto auto 0;"></p>
<p><b>Fig. </b> 3: <em>Function-based colour schemes showing scheme name. There is no limit on the number of colours when using these schemes.</em></p>
</div>
<div id="pre-defined-colours" class="section level5">
<h5 class="hasAnchor">
<a href="#pre-defined-colours" class="anchor"></a>6.1.1.2 Pre-defined colours</h5>
<p>PD colours have pre-defined values as well as a pre-defined length of colours. PD colours are always selected in the same sequence of colours. For example, <strong>Standard</strong> palette produces Blue and Red when <em>K</em>=2 and Blue, Red and Green when <em>K</em>=3 etc. New colours are added to the end of sequence as <em>K</em> increases. Pre-defined colour schemes are shown below.</p>
<p><img src="guide_files/figure-html/unnamed-chunk-4-1.png" width="768" style="display: block; margin: auto auto auto 0;"></p>
<p><b>Fig. </b> 4: <em>Pre-defined colour schemes showing scheme name and length of colours.</em></p>
<p>An extra category of <strong>Pre Defined</strong> colours called <strong>Pre Defined ColorBrewer</strong> is available. This option makes available colour palettes from <a href="http://colorbrewer2.org/">Colorbrewer</a>. Note that Colourbrewer palettes have a limit on the number of colours.</p>
<p><img src="guide_files/figure-html/unnamed-chunk-5-1.png" width="432" style="display: block; margin: auto auto auto 0;"></p>
<p><b>Fig. </b> 5: <em>Pre-defined colour schemes from Colorbrewer showing palette name and length of colours.</em></p>
</div>
</div>
<div id="align-clustersmerge-runs" class="section level4">
<h4 class="hasAnchor">
<a href="#align-clustersmerge-runs" class="anchor"></a>6.1.2 Align clusters/Merge runs</h4>
<p>When two or more runs are selected, a dropdown menu is available to align clusters or merge runs. Align clusters/Merge runs only works if the selected runs are of same run format and same number of individuals. For structure runs, the number of loci must be same too. <strong>Align within K</strong> align clusters between replicate runs of each K. <strong>Align across K</strong> first aligns clusters within K and then across K. The runs are reordered after alignment, but the number of runs and the order of individuals remain the same. <strong>Merge runs</strong> aligns runs across K and then merges replicate runs within each K. The number of runs will be lower after merging. If all runs belong to the same K, aligning across K is disabled and merging returns one run.</p>
</div>
<div id="order-individuals" class="section level4">
<h4 class="hasAnchor">
<a href="#order-individuals" class="anchor"></a>6.1.3 Order individuals</h4>
<p>Order/Sort individuals by individual labels, one of the clusters or all clusters. Based on the selected run/runs, the sortable clusters are shown in the dropdown menu. For eg: if runs <em>K</em>=3 and <em>K</em>=4 are selected, sortable clusters would be Cluster1, Cluster2 and Cluster3, since Cluster4 is not present in one of the files. If one of the clusters is selected (Eg. Cluster1), all selected runs are sorted by the selected cluster. If <strong>All</strong> is selected, then run(s) are sorted using all the clusters using a method similar to <strong>Sort by Q</strong> option in the STRUCTURE software. If group labels (section 6.1.5) are in use, individuals are sorted within the groups.</p>
</div>
<div id="individual-labels" class="section level4">
<h4 class="hasAnchor">
<a href="#individual-labels" class="anchor"></a>6.1.4 Individual labels</h4>
<p>Individuals are labelled numerically by default. By checking <strong>Use individual labels</strong>, individual labels can be read in from input STRUCTURE files, pasting into the input field or by uploading an individual labels file. Selecting <strong>Upload file</strong> allows to upload a single column text file with individual labels. This file must be tab-delimited or comma-separated. It must have no headers. Selecting <strong>Paste text</strong> allows for the labels to be pasted or manually typed in. It is possible to copy-paste from a spreadsheet (Excel) or text editor. The number of labels must be equal to the number of individuals in the run file. These individual labels are used when sorting individuals by labels (section 6.1.3). By checking <strong>Show individual labels</strong>, these labels are displayed under the plot (for standard and interactive plot). Checking <strong>Use individual labels</strong> also displays the <strong>Individual label options</strong> panel. More details about this panel is described under Individual label options (section 6.2.2).</p>
<p>When group labels (section 6.1.5) are used alongside individual labels, a checkbox option <strong>Concatenate ind &amp; group labels</strong> becomes active. Checking this concatenates all group labels with individual labels to create a long individual label per sample. The separator between the concatenated labels can be specified.</p>
</div>
<div id="group-labels" class="section level4">
<h4 class="hasAnchor">
<a href="#group-labels" class="anchor"></a>6.1.5 Group labels</h4>
<p>Population labels can be displayed under the plots (for standard plots) and in the hover tooltips (for interactive plot). Selecting the <strong>Upload file</strong>, group labels can be uploaded as a text file (tab-delimited or a comma-separated) with one or more columns. The file MUST have a header. Each column is referred to as a group label set. The headers are referred to as group label titles. And the actual labels are referred to as group label text. The number of rows must be equal to the number of individuals in the run file. Download a sample file in Downloads (section 7).</p>
<p>Selecting <strong>Paste text</strong> allows for the labels to be pasted or manually typed in. In this case only one label set (one column) is allowed. One label per line. There should be no header. Just to be clear, if this one column group label is uploaded as a file, it must have a header.</p>
</div>
<div id="active-group-label-title" class="section level4">
<h4 class="hasAnchor">
<a href="#active-group-label-title" class="anchor"></a>6.1.6 Active group label title</h4>
<p>All available group label titles are listed in the dropdown menu. The first group label title is automatically selected as the active set. This can be changed by selecting another group label title from the dropdown menu. The active group label set is used for grouping when sorting individuals (section 6.1.3), subsetting (section 6.1.7), ordering groups (section 6.1.8) and when computing mean (section 6.1.9) over groups.</p>
</div>
<div id="subsetorder-group" class="section level4">
<h4 class="hasAnchor">
<a href="#subsetorder-group" class="anchor"></a>6.1.7 Subset/Order group</h4>
<p>Based on the active group label set (section 6.1.6), group labels from that set are available to subset or reorder. The default is <strong>None</strong> which means do not subset or reorder. <strong>None</strong> must be deleted for this widget to be active.</p>
<p>Groups can be subsetted by selecting one or more groups. Delete a selected pop using the <kbd>Backspace</kbd> key. Use the <kbd>Left</kbd> <kbd>Right</kbd> arrow keys to jump to labels. Position of groups can be changed by changing their order in the widget. For eg. An initial order of <em>Grp A, Grp B</em> can be changed to <em>Grp B, Grp A</em>.</p>
</div>
<div id="order-group-labels" class="section level4">
<h4 class="hasAnchor">
<a href="#order-group-labels" class="anchor"></a>6.1.8 Order group labels</h4>
<p>When group labels are not in contiguous blocks or they are ordered non-alphabetically, they can be reordered by checking the option <strong>Order group labels</strong>. All group label sets are ordered alphabetically starting with the active group label set (section 6.1.3).</p>
</div>
<div id="compute-mean-over-groups" class="section level4">
<h4 class="hasAnchor">
<a href="#compute-mean-over-groups" class="anchor"></a>6.1.9 Compute mean over groups</h4>
<p>Mean across all individuals within the currently active group (section 6.1.3) is computed and displayed.</p>
</div>
</div>
<div id="standard-plot" class="section level3">
<h3 class="hasAnchor">
<a href="#standard-plot" class="anchor"></a>6.2 Standard Plot</h3>
<p><img src="www/plotrunsnolabs.png"></p>
<p><b>Fig. </b> 6: <em>Sample of a single plot on left and a sample of joined plot on the right.</em></p>
<div id="standard-options" class="section level4">
<h4 class="hasAnchor">
<a href="#standard-options" class="anchor"></a>6.2.1 Standard options</h4>
<p>These are basic options that apply to the standard plot. The standard options are organised into the following sections: general options, side panel options, title options, subtitle options and legend options. Each section has a <strong>Reset panel</strong> button which resets all settings in that section to default settings.</p>
<p>The <strong>Bar size</strong> controls the width of the bars. The <strong>Bar border size</strong> controls the border size on bars. <strong>Bar border colour</strong> sets the border colour on the bars. The colour is only visible when the border size &gt;0. <strong>Show Y axis</strong> when checked displays the Y-axis. This also displays additional widgets to control size and length of ticks. When two or more runs are selected, the <strong>Panel spacer</strong> option is used to adjust spacing between run panels on the plot.</p>
<p><strong>Show side panel</strong> when checked displays a side panel on the right side of standard displaying the filename and <em>K</em> value. The default labels can be changed by providing comma separated labels. Other side panel options control side panel position, text size, text colour and background colour. Click on the <strong>Reset panel</strong> button to reset all the settings in the side panel options.</p>
<p>Checking <strong>Show plot title</strong> displays a title on top of the plot. The label can be changed as well as the title text size, title spacer (the space between the title and the region below), horizontal and vertical justification and the title colour.</p>
<p>Checking <strong>Show plot subtitle</strong> displays a subtitle on top of the plot. The label can be changed as well as the subtitle text size, subtitle spacer (the space between the subtitle and the region below), horizontal and vertical justification and the subtitle colour.</p>
<p>Checking <strong>Show cluster legend</strong> displays a legend showing cluster colours. The legend labels default to cluster names, but this can be changed by providing a comma separated label list. The legend text size, key size and spacing can be adjusted.</p>
</div>
<div id="individual-label-options" class="section level4">
<h4 class="hasAnchor">
<a href="#individual-label-options" class="anchor"></a>6.2.2 Individual label options</h4>
<p>Checking <strong>Use individual labels</strong> (section 6.1.4) displays the <strong>Individual label options</strong> panel. The <strong>Common individual labels</strong> option when checked displays individual labels only under the lowermost plot (for standard plot and in case multiple plots are displayed). Unchecking this option displays individual labels under each plot panel. When sorting individuals by cluster (section 6.1.3), <strong>Common individual labels</strong> option must be unchecked.</p>
<p>The individual labels panel height can be adjusted along with the spacer (space between the individual labels and the region above). The label size, colour, horizontal and vertical justification and angle can be adjusted.</p>
</div>
<div id="group-label-options" class="section level4">
<h4 class="hasAnchor">
<a href="#group-label-options" class="anchor"></a>6.2.3 Group label options</h4>
<p>Checking <strong>Use group labels</strong> (section 6.1.5) displays the <strong>Group label options</strong> panel. This panel is organised into the following sections: general options, text options, point options, line options and divider options.</p>
<p><img src="www/figure-scheme.png"></p>
<p><b>Fig. </b> 7: <em>A typical joined plot with group labels. Various parts of the figure and options to customise.</em></p>
<p>The group labels panel height can be adjusted along with the spacer (space between the group labels and the region above). The panel ratio takes two numbers separated by a comma denoting ratio of plot area to group-label area like <code>3,1</code>. The <strong>Label marker colour</strong> is the colour applied to all label marker elements such as lines and points.</p>
<p>The text options control the text y-position, text colour, size, angle and horizontal justification. Label points separate the groups. The point size (ex. 1) and point type can be adjusted. The default point type is <code>|</code>. This can be changed to any character. If a number is provided, then a standard R plotting symbol (pch) is used instead. Point options control point size and point type.</p>
<p><img src="www/rpch.png"></p>
<p><b>Fig. </b> 8: <em>Number for plotting characters.</em></p>
<p>The horizontal line seen with the labels is the label line. Line options control line y-position, line thickness and line type. The line type can be a single digit or double digit number. A single digit denotes one of the line types in the figure below. A double digit denotes the length of mark and length of the space. For example, 22 means a line with a mark of distance 2 followed by a space of distance 2.</p>
<p><img src="www/rlty.png"></p>
<p><b>Fig. </b> 9: <em>A few of the line types.</em></p>
<p>Divider options control the vertical lines separating groups. The divider lines are drawn between groups of the active group label set (section 6.1.6). This can be changed to one or more group label sets by selecting the group label title. Use arrow keys to move cursor left/right. Use backspace to remove a label. Other options allow to control the thickness of the div line and the line type.</p>
</div>
<div id="image-preview-scale" class="section level4">
<h4 class="hasAnchor">
<a href="#image-preview-scale" class="anchor"></a>6.2.4 Image preview scale</h4>
<p>The image preview scale slider allows to adjust the display size of the preview plot in the browser. The scale does not affect the download options.</p>
</div>
<div id="download-options" class="section level4">
<h4 class="hasAnchor">
<a href="#download-options" class="anchor"></a>6.2.5 Download options</h4>
<p>Empty fields for height and width will generate default values (recommended). <strong>Note</strong>: The height is height of one run panel and not the height of the entire figure. If 2 runs are selected, a height of 2 cm means each run will be 2 cm and the final figure will be around 4 cm high. The default image resolution is 200dpi. When specifying height and width, note that it is in cm. Changing the file type does not change the preview but it changes the downloaded file type.</p>
</div>
</div>
<div id="interactive-plot" class="section level3">
<h3 class="hasAnchor">
<a href="#interactive-plot" class="anchor"></a>6.3 Interactive Plot</h3>
<p>The interactive plot makes it easier to explore the data. It allows zoom control, drag/slide and hover tool tips to identify samples. Note that interactive plots are computationally more intensive to display and change.</p>
<div id="interactive-plot-usage" class="section level4">
<h4 class="hasAnchor">
<a href="#interactive-plot-usage" class="anchor"></a>6.3.1 Interactive plot usage</h4>
<p>Hovering the cursor over the plot shows the current position (Cur Pos), original position (Orig Pos), individual ID, cluster (<em>K</em>) and the y-axis value (assignment probability) in the tool tip. If group labels (section 6.1.5) are in use, group label from each group label set is also displayed for that individual. The original position may be useful when sorting the individuals. The original position does not work with <strong>Align/Merge runs (within K)</strong> option. When individual labels (section 6.1.4) are in use, individual labels is shown as individual ID.</p>
<p>Click and drag on the plot to zoom in. Click <strong>Reset</strong> to reset zoom. When zoomed in, press shift and drag to slide the view. Clusters can be turned on or off by clicking on the legend icons (top right). When multiple runs are selected, plots are created one below the other in the order in which the files are selected. Click on the top left corner and choose an option to download the plot.</p>
</div>
<div id="interactive-options" class="section level4">
<h4 class="hasAnchor">
<a href="#interactive-options" class="anchor"></a>6.3.2 Interactive options</h4>
<p>The height and width of plots can be adjusted. The size of the bar border and the spacing between bars can be adjusted. The legend can be turned on or off. The filename can be shown on the bottom right or on top left.</p>
</div>
</div>
</div>
<div id="downloads" class="section level2">
<h2 class="hasAnchor">
<a href="#downloads" class="anchor"></a>7. Downloads</h2>
<ul>
<li>Download STRUCTURE 2.3.4 run files, group labels and individual labels <a href="https://www.dropbox.com/s/wt28ksmjucb7pjv/structure.zip?dl=1">here</a>.<br>
</li>
<li>Download TESS 2.3 run files and group labels <a href="https://www.dropbox.com/s/4aexcv75p1f10u9/tess.zip?dl=1">here</a>.<br>
</li>
<li>Download a BAPS run file <a href="https://www.dropbox.com/s/aprqximvj8b0f8e/baps.zip?dl=1">here</a>.</li>
<li>Download ADMIXTURE run files and group labels <a href="https://www.dropbox.com/s/q13y3qchd8jopeb/admixture.zip?dl=1">here</a>.<br>
</li>
<li>Download fastSTRUCTURE run files and group labels <a href="https://www.dropbox.com/s/woe2nvul3c2whjn/faststructure.zip?dl=1">here</a>.<br>
</li>
<li>Download combined, aligned and merged CLUMPP files <a href="https://www.dropbox.com/s/nb3t1zv2rbq49x8/clumpp.zip?dl=1">here</a>.</li>
</ul>
</div>
<div id="troubleshooting" class="section level2">
<h2 class="hasAnchor">
<a href="#troubleshooting" class="anchor"></a>8. Troubleshooting</h2>
<ul>
<li><p><strong>Nothing visible in Evanno tab:</strong> Evanno option is available only for structure runs. Likely issue is that uploaded files are not STRUCTURE runs or consists of mixed formats.</p></li>
<li><p><strong>When uploading lots of files to the web app, the upload bar tends to be frozen:</strong> The bar sometimes appear frozen, but the upload is in progress. The summary table should be visible after a few minutes. Better to zip all the files into one file and upload. This issue is only applicable to the online version of the app.</p></li>
<li><p><strong>A popup error with ‘The application unexpectedly exited.’:</strong> This error is reported when the app has crashed. This can happen due to a whole range of unexpected issues. The solution is to refresh the browser and continue as normal. Else, close tab and open webpage in new tab. If this happens consistently, please report to me with explanation on what you were doing when it happened. This issue is only applicable to the online version of the app.</p></li>
<li><p><strong>After working with some files, reuploading new files in the same session often produces a pop-up error like ‘The application unexpectedly exited’:</strong> The solution is to refresh the browser or reload the page and pretend this didn’t happen. This issue is only applicable to the online version of the app.</p></li>
<li><p>If you want to validate the results (Evanno plot, CLUMPP results) produced here, or if this service does not work, check out <a href="http://taylor0.biology.ucla.edu/structureHarvester/">StructureHarvester</a>.</p></li>
<li><p>Under standard plot options, the sub sections can be collapsed by clicking on the section title. For example <strong>&gt; Standard options</strong>, <strong>&gt; General options</strong> etc. This might be useful to quickly reduce clutter. But note that hidden widgets are not accessible to the plotting function and can lead to strange errors.</p></li>
<li><p><strong>Online app is slow and unresponsive:</strong> Yes. The app is not intended for large datasets. You should probably use the R package. The app may be slow with multiple simultaneous users. If the app seems to be slow and unresponsive even with small datasets, try again later. This issue is only applicable to the online version of the app.</p></li>
</ul>
<blockquote>
<p>If using the online web app, note that it is a web based GUI running on a basic server and not a computing cluster. Be reasonable. Please do not use massive datasets. The computationally demanding part is the plotting. Data tabs and Evanno method should work fine. I have tried 25 files with 2000 individuals and plotted them all at the same time. It worked but was quite slow. So, this is pushing the limits here. I have also tried plotting 60 files with 150 individuals. That worked too but a bit slow. Note that interactive plots can be extremely slow (several minutes) with anything more than a few hundred individuals.</p>
</blockquote>
</div>
<div id="citation" class="section level2">
<h2 class="hasAnchor">
<a href="#citation" class="anchor"></a>9. Citation</h2>
<blockquote>
<p>Francis, R. M. (2017). POPHELPER: an R package and web app to analyse and visualize population structure. <em>Molecular Ecology Resources, 17</em>(1), 27-32. DOI: 10.1111/1755-0998.12509</p>
</blockquote>
</div>
<div id="references" class="section level2">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>10. References</h2>
<ol style="list-style-type: decimal">
<li>Adrian A. Dragulescu and Cole Arendt (2018). xlsx: Read, Write, Format Excel 2007 and Excel 97/2000/XP/2003 Files. R package version 0.6.1. <a href="https://CRAN.R-project.org/package=xlsx" class="uri">https://CRAN.R-project.org/package=xlsx</a><br>
</li>
<li>Allaire J, Horner J, Marti V, Porte N (2017) markdown: ‘Markdown’ Rendering for R. R package version 0.8. <a href="http://CRAN.R-project.org/package=markdown" class="uri">http://CRAN.R-project.org/package=markdown</a><br>
</li>
<li>Dean Attali (2017). colourpicker: A Colour Picker Tool for Shiny and for Selecting Colours in Plots. R package version 1.0. <a href="https://CRAN.R-project.org/package=colourpicker" class="uri">https://CRAN.R-project.org/package=colourpicker</a><br>
</li>
<li>Baptiste Auguie (2017). gridExtra: Miscellaneous Functions for “Grid” Graphics. R package version 2.3. <a href="https://CRAN.R-project.org/package=gridExtra" class="uri">https://CRAN.R-project.org/package=gridExtra</a><br>
</li>
<li>Eric Bailey (2015). shinyBS: Twitter Bootstrap Components for Shiny. R package version 0.61. <a href="https://CRAN.R-project.org/package=shinyBS" class="uri">https://CRAN.R-project.org/package=shinyBS</a><br>
</li>
<li>Winston Chang, Joe Cheng, JJ Allaire, Yihui Xie and Jonathan McPherson (2018). shiny: Web Application Framework for R. R package version 1.1.0. <a href="https://CRAN.R-project.org/package=shiny" class="uri">https://CRAN.R-project.org/package=shiny</a><br>
</li>
<li>Evanno G, Regnaut S, Goudet J (2005) Detecting the number of clusters of individuals using the software STRUCTURE: a simulation study. Molecular Ecology 14, 2611-2620.<br>
</li>
<li>Jakobsson M, Rosenberg NA (2007) CLUMPP: a cluster matching and permutation program for dealing with label switching and multimodality in analysis of population structure. Bioinformatics 23, 1801-1806.<br>
</li>
<li>Joshua Kunst (2017). highcharter: A Wrapper for the ‘Highcharts’ Library. R package version 0.5.0. <a href="https://CRAN.R-project.org/package=highcharter" class="uri">https://CRAN.R-project.org/package=highcharter</a><br>
</li>
<li>Vincent Nijs, Forest Fang, Trestle Technology, LLC and Jeff Allen (2018). shinyAce: Ace Editor Bindings for Shiny. R package version 0.3.1. <a href="https://CRAN.R-project.org/package=shinyAce" class="uri">https://CRAN.R-project.org/package=shinyAce</a><br>
</li>
<li>R Development Core Team (2013) R: A language and environment for statistical computing. R Foundation for Statistical Computing. Vienna. <a href="http://www.R-project.org/" class="uri">http://www.R-project.org/</a><br>
</li>
<li>Simon Garnier (2018). viridisLite: Default Color Maps from ‘matplotlib’ (Lite Version). R package version 0.3.0. <a href="https://CRAN.R-project.org/package=viridisLite" class="uri">https://CRAN.R-project.org/package=viridisLite</a><br>
</li>
<li>Wickham H, Romain Francois, Lionel Henry and Kirill Muller (2018). dplyr: A Grammar of Data Manipulation. R package version 0.7.6. <a href="https://CRAN.R-project.org/package=dplyr" class="uri">https://CRAN.R-project.org/package=dplyr</a><br>
</li>
<li>Hadley Wickham and Lionel Henry (2018). tidyr: Easily Tidy Data with ‘spread()’ and ‘gather()’ Functions. R package version 0.8.1. <a href="https://CRAN.R-project.org/package=tidyr" class="uri">https://CRAN.R-project.org/package=tidyr</a><br>
</li>
<li>Wickham H (2009) ggplot2: elegant graphics for data analysis Springer.<br>
</li>
<li>Wickham H (2011) The Split-Apply-Combine Strategy for Data Analysis. Journal of Statistical Software 40, 1-29.<br>
</li>
<li>Wickham H (2016) gtable: Arrange grobs in tables.. R package version 0.2.0. <a href="http://CRAN.R-project.org/package=gtable" class="uri">http://CRAN.R-project.org/package=gtable</a><br>
</li>
<li>Winston Chang (2016). shinythemes: Themes for Shiny. R package version 1.1.1. <a href="https://CRAN.R-project.org/package=shinythemes" class="uri">https://CRAN.R-project.org/package=shinythemes</a><br>
</li>
<li>Yihui Xie (2018). DT: A Wrapper of the JavaScript Library ‘DataTables’. R package version 0.4. <a href="https://CRAN.R-project.org/package=DT" class="uri">https://CRAN.R-project.org/package=DT</a>
</li>
</ol>
</div>
<div id="contact" class="section level2">
<h2 class="hasAnchor">
<a href="#contact" class="anchor"></a>11 Contact</h2>
<p>If you have any comments, suggestions or would like to report an issue, please create an issue on the PophelperShiny <a href="https://github.com/royfrancis/pophelperShiny">GitHub</a> page.</p>
</div>
<div id="session" class="section level2">
<h2 class="hasAnchor">
<a href="#session" class="anchor"></a>12 Session</h2>
<pre><code>## R version 3.6.0 (2019-04-26)
## Platform: x86_64-pc-linux-gnu (64-bit)
## Running under: Ubuntu 18.04.3 LTS
## 
## Matrix products: default
## BLAS:   /usr/lib/x86_64-linux-gnu/openblas/libblas.so.3
## LAPACK: /usr/lib/x86_64-linux-gnu/libopenblasp-r0.2.20.so
## 
## locale:
##  [1] LC_CTYPE=en_GB.UTF-8       LC_NUMERIC=C              
##  [3] LC_TIME=en_GB.UTF-8        LC_COLLATE=en_GB.UTF-8    
##  [5] LC_MONETARY=en_GB.UTF-8    LC_MESSAGES=en_GB.UTF-8   
##  [7] LC_PAPER=en_GB.UTF-8       LC_NAME=C                 
##  [9] LC_ADDRESS=C               LC_TELEPHONE=C            
## [11] LC_MEASUREMENT=en_GB.UTF-8 LC_IDENTIFICATION=C       
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
## [1] highcharter_0.7.0  dplyr_0.8.3        tidyr_0.8.3       
## [4] stringr_1.4.0      ggplot2_3.2.1      RColorBrewer_1.1-2
## [7] captioner_2.2.3    bookdown_0.12      knitr_1.23        
## 
## loaded via a namespace (and not attached):
##  [1] zoo_1.8-6         tidyselect_0.2.5  xfun_0.8         
##  [4] purrr_0.3.2       lattice_0.20-38   colorspace_1.4-1 
##  [7] generics_0.0.2    viridisLite_0.3.0 htmltools_0.3.6  
## [10] yaml_2.2.0        rlang_0.4.0       pkgdown_1.3.0    
## [13] pillar_1.4.2      glue_1.3.1        withr_2.1.2      
## [16] TTR_0.23-4        quantmod_0.4-15   munsell_0.5.0    
## [19] commonmark_1.7    gtable_0.3.0      htmlwidgets_1.3  
## [22] memoise_1.1.0     evaluate_0.14     curl_4.0         
## [25] broom_0.5.2       xts_0.11-2        Rcpp_1.0.2       
## [28] scales_1.0.0      backports_1.1.4   desc_1.2.0       
## [31] jsonlite_1.6      fs_1.3.1          digest_0.6.20    
## [34] stringi_1.4.3     rlist_0.4.6.1     grid_3.6.0       
## [37] rprojroot_1.3-2   tools_3.6.0       magrittr_1.5     
## [40] lazyeval_0.2.2    tibble_2.1.3      whisker_0.3-2    
## [43] crayon_1.3.4      pkgconfig_2.0.2   MASS_7.3-51.4    
## [46] data.table_1.12.2 xml2_1.2.1        lubridate_1.7.4  
## [49] assertthat_0.2.1  rmarkdown_1.14    roxygen2_6.1.1   
## [52] rstudioapi_0.10   R6_2.4.0          igraph_1.2.4.1   
## [55] nlme_3.1-139      compiler_3.6.0</code></pre>
<p><strong>End of Document</strong></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#general">1. General</a></li>
      <li><a href="#features">2. Features</a></li>
      <li><a href="#file-upload">3. File upload</a></li>
      <li><a href="#data">4. Data</a></li>
      <li><a href="#evanno-method">5. Evanno method</a></li>
      <li><a href="#plotting">6. Plotting</a></li>
      <li><a href="#downloads">7. Downloads</a></li>
      <li><a href="#troubleshooting">8. Troubleshooting</a></li>
      <li><a href="#citation">9. Citation</a></li>
      <li><a href="#references">10. References</a></li>
      <li><a href="#contact">11 Contact</a></li>
      <li><a href="#session">12 Session</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Roy Francis.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
